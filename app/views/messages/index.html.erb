<div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Direct Messages</h3>
    <button id="mark-all-dm-as-read" class="btn btn-md btn-outline-dark">Mark As Read</button>
</div>

<hr/>

<div id="message-notificaions-container">
    <% @msg_notifications.each do |notification|%>
        <% if notification.unread? %>
        <div class="d-flex justify-content-between align-items-center">
            <p><%= notification.message.html_safe %></p>
            <% if notification.file_attached? %>
                <%= link_to "View Attachment", notification.record, class: "view-msg-btn link-dark", data: {"notification-event-id": notification.event.id} %>
            <% end %>
        <% end %>
        </div>
    <% end %>
</div>


<script>
    $(() => {
        $("#mark-all-dm-as-read").on("click", (event)=>{
            event.preventDefault();

            $.ajax({
                type: "post",
                url: `http://localhost:3000/notifications/mark_all_dm_as_read`,
                success: function (response) {
                    $("#unread-messages-count").removeClass("visible").addClass("invisible");
                    $("#message-notificaions-container").empty();
                }
            });

            event.stopPropagation();
            event.stopImmediatePropagation();
        });
    });
</script>